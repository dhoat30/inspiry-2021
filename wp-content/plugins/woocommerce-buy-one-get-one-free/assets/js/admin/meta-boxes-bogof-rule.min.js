!function(a){if("undefined"!=typeof wc_admin_bogof_meta_boxes_params){var e={init:function(){a("#_type").on("change",this.on_type_change).on("change",function(){a("#_buy_product_ids").val(null).trigger("change")}).on("change",this.on_free_qty_keyup),a("#_applies_to").on("change",this.on_applies_to_change),a("#_action").on("change",this.on_action_change),a("#_free_quantity").on("keyup mouseup",this.on_free_qty_keyup).on("blur",this.remove_error_tips),a("#_min_quantity").on("change",this.on_free_qty_keyup),a("#woocommerce-bogo-rule-data").on("click","a.wc-bogof-rule-toggle-enabled",this.on_toggle_enabled),a("#woocommerce-bogo-rule-data").on("change","#_available_for",this.on_available_for_change),this.make_toggle(),this.on_type_change(),this.on_applies_to_change(),this.on_action_change(),this.on_available_for_change()},add_error_tip:function(e,o){var t=e.position();0===e.parent().find(".wc_bogof_error_tip").length&&(e.after('<div class="wc_bogof_error_tip '+o+'">'+wc_admin_bogof_meta_boxes_params[o]+"</div>"),e.parent().find(".wc_bogof_error_tip").css("left",t.left+e.width()-e.width()/2-a(".wc_bogof_error_tip").width()/2).css("top",t.top+e.height()).fadeIn("100"))},remove_error_tip:function(e,o){e.parent().find(".wc_bogof_error_tip."+o).fadeOut("100",function(){a(this).remove()})},remove_error_tips:function(){a(this).parent().find(".wc_bogof_error_tip").fadeOut("100",function(){a(this).remove()})},on_type_change:function(){a("#_action").closest("div.options_group").toggle("buy_a_get_b"===a("#_type").val()),a("#_individual").closest("div.options_group").toggle("buy_a_get_b"===a("#_type").val()&&"category"===a("#_applies_to").val()),"buy_a_get_b"!==a("#_type").val()?(a("#_buy_product_ids").data("action","wc_bogof_json_search_free_products"),a("#_buy_product_ids").data("exclude",wc_admin_bogof_meta_boxes_params.incompatible_types)):(a("#_buy_product_ids").data("action",""),a("#_buy_product_ids").data("exclude",""))},on_applies_to_change:function(){a("p._buy_product_ids_field").toggle("product"===a("#_applies_to").val()),a("p._buy_category_ids_field").toggle("category"===a("#_applies_to").val()),a("#_individual").closest("div.options_group").toggle("buy_a_get_b"===a("#_type").val()&&"category"===a("#_applies_to").val())},on_action_change:function(){var e="show_if_"+a("#_action").val();a("p.action_objects_fields").hide(),a("p.action_objects_fields."+e).show()},on_free_qty_keyup:function(){"cheapest_free"!==a("#_type").val()?e.remove_error_tip(a("#_free_quantity"),"i18n_free_less_than_min_error"):parseInt(a("#_min_quantity").val(),10)<=parseInt(a("#_free_quantity").val(),10)?e.add_error_tip(a("#_free_quantity"),"i18n_free_less_than_min_error"):e.remove_error_tip(a("#_free_quantity"),"i18n_free_less_than_min_error")},on_toggle_enabled:function(e){e.preventDefault();var o=a(this).find("span.woocommerce-input-toggle"),t=!a("input#_enabled").prop("checked");a("input#_enabled").prop("checked",t);var _=a("input#_enabled").prop("checked")?"enabled":"disabled";o.removeClass("woocommerce-input-toggle--enabled").removeClass("woocommerce-input-toggle--disabled").addClass("woocommerce-input-toggle--"+_)},make_toggle:function(){var e=a("p.form-field._enabled_field"),o=e.find("span.description").text(),t=e.find("input#_enabled").prop("checked")?"enabled":"disabled";e.find("span.description").hide(),e.find("input#_enabled").hide(),e.append('<a href="#" class="wc-bogof-rule-toggle-enabled"><span class="woocommerce-input-toggle woocommerce-input-toggle--'+t+'" aria-label="'+o+'"></span>')},on_available_for_change:function(){a("#_allowed_user_roles").closest("p").toggle("roles"==a("#_available_for").val())}};e.init(),a("tr.type-shop_bogof_rule").on("click",".wc-bogof-rule-toggle-enabled",function(e){e.preventDefault();var o=a(this),t=o.find(".woocommerce-input-toggle"),_={action:"wc_bogof_toggle_rule_enabled",security:wc_admin_bogof_meta_boxes_params.nonces.rule_toggle,rule_id:o.data("rule_id")};return t.addClass("woocommerce-input-toggle--loading"),a.ajax({url:woocommerce_admin.ajax_url,data:_,dataType:"json",type:"POST",success:function(e){!0===e.data?(t.removeClass("woocommerce-input-toggle--enabled, woocommerce-input-toggle--disabled"),t.addClass("woocommerce-input-toggle--enabled"),t.removeClass("woocommerce-input-toggle--loading")):!1===e.data&&(t.removeClass("woocommerce-input-toggle--enabled, woocommerce-input-toggle--disabled"),t.addClass("woocommerce-input-toggle--disabled"),t.removeClass("woocommerce-input-toggle--loading"))}}),!1})}}(jQuery);